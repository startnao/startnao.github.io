<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>StartNao</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="StartNao">
<meta property="og:url" content="http://startnao.github.io/index.html">
<meta property="og:site_name" content="StartNao">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="StartNao">
<meta name="twitter:description">
<meta name="twitter:creator" content="@StartNao">
  
    <link rel="alternative" href="/atom.xml" title="StartNao" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-61190111-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">StartNao</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/Project-Definition">Project Definition</a>
        
          <a class="main-nav-link" href="https://twitter.com/StartNao">Twitter</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="q" value="site:http://startnao.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-OpenCV-red-ball-detection" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/18/OpenCV-red-ball-detection/" class="article-date">
  <time datetime="2015-05-18T13:02:16.000Z" itemprop="datePublished">18-05-2015</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/18/OpenCV-red-ball-detection/">OpenCV, red ball detection</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[4] We are trying to detect red balls on the Nao. First we did it on our computer, here is the code:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python </span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment">#cap = cv2.VideoCapture(0)</span></span><br><span class="line">c = cv2.VideoCapture(<span class="number">0</span>)</span><br><span class="line">detected = <span class="keyword">False</span></span><br><span class="line"><span class="keyword">while</span>(detected <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">True</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Take each frame</span></span><br><span class="line">    _, img = c.read()</span><br><span class="line">    img = cv2.flip(img,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convert BGR to HSV</span></span><br><span class="line">    hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#cv2.imshow("b", hsv)</span></span><br><span class="line">    <span class="comment"># define range of blue color in HSV</span></span><br><span class="line">    lower_color = np.array([<span class="number">110</span>,<span class="number">50</span>,<span class="number">50</span>], dtype=np.uint8)</span><br><span class="line">    upper_color = np.array([<span class="number">130</span>,<span class="number">255</span>,<span class="number">255</span>], dtype=np.uint8)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Threshold the HSV image to get only blue colors</span></span><br><span class="line">    mask = cv2.inRange(hsv, lower_color, upper_color)</span><br><span class="line">    <span class="comment">#cv2.imshow('mask',mask)  </span></span><br><span class="line">    <span class="comment"># Bitwise-AND mask and original image</span></span><br><span class="line">    res = cv2.bitwise_and(img,img, mask= mask)</span><br><span class="line">    <span class="comment">#cv2.imshow("b", res)</span></span><br><span class="line"></span><br><span class="line">    imgray = cv2.cvtColor(res,cv2.COLOR_BGR2GRAY)</span><br><span class="line">    ret,thresh = cv2.threshold(imgray,<span class="number">127</span>,<span class="number">255</span>,<span class="number">0</span>)</span><br><span class="line">    contours, hierarchy = cv2.findContours(imgray,cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">#erode = cv2.erode(res,None,iterations = 3)</span></span><br><span class="line">    <span class="comment">#dilate = cv2.dilate(erode,None,iterations = 10)</span></span><br><span class="line">    <span class="comment">#contours,hierarchy = cv2.findContours(res,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)</span></span><br><span class="line">    <span class="keyword">for</span> cnt <span class="keyword">in</span> contours:</span><br><span class="line"></span><br><span class="line">        x,y,w,h = cv2.boundingRect(cnt)</span><br><span class="line">        <span class="keyword">print</span> w,h</span><br><span class="line">        <span class="keyword">if</span>(w &lt; <span class="number">60</span> <span class="keyword">or</span> h &lt; <span class="number">60</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        cx,cy = x+w/<span class="number">2</span>, y+h/<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="number">20</span> &lt; res.item(cy,cx,<span class="number">0</span>) &lt; <span class="number">30</span>:</span><br><span class="line">             <span class="comment">#cv2.rectangle(f,(x,y),(x+w,y+h),[0,255,255],2)</span></span><br><span class="line">            <span class="keyword">print</span> <span class="string">"yellow :"</span>, x,y,w,h</span><br><span class="line">        <span class="keyword">elif</span> <span class="number">100</span> &lt; res.item(cy,cx,<span class="number">0</span>) &lt; <span class="number">120</span>:</span><br><span class="line">             cv2.rectangle(img,(x,y),(x+w,y+h),[<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>],<span class="number">2</span>)</span><br><span class="line">             <span class="keyword">print</span> <span class="string">"blue :"</span>, x,y,w,h</span><br><span class="line">        cv2.imshow(<span class="string">'img'</span>,img)  </span><br><span class="line"></span><br><span class="line">    k = cv2.waitKey(<span class="number">5</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">27</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>
<p>On the computer, this code work fine, but on the Nao, it seems that the image processing is too slow. Our project manager contacted Aldebaran to know more about this issue.<br>They recommended us to use Nao library to import the camera image insted of using cv2 library.</p>
<p>We are know trying to adapt our code to these guidelines to make all that work.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://startnao.github.io/2015/05/18/OpenCV-red-ball-detection/" data-id="ci9txc8id00048shcszr313r2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Python-OpenCV-and-Nao" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/16/Python-OpenCV-and-Nao/" class="article-date">
  <time datetime="2015-05-16T19:01:14.000Z" itemprop="datePublished">16-05-2015</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/16/Python-OpenCV-and-Nao/">Python, OpenCV and Nao</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[ 2] In the group II, we are currently working with OpenCV in order to detect motion, quantify it and execute actions under certain conditions. For the moment, the Python code works well on our computers (it detects the motion accordingly to what we wanted). The next step is to put that code on the NAO to make it detect what we want.</p>
<p>This article aims to explain the process we followed to understand how OpenCV work and to detect an amout of motion in an image.</p>
<h2 id="I-_Discover_OpenCV">I. Discover OpenCV</h2><p>We discovered the basics of OpenCV by speaking with another group who use it to detect colors. In a few minutes, we were able to find a code on Internet that would read the input of the computer camera and display it in a window.</p>
<p>This code let us understand how OpenCV work a little bit:</p>
<ul>
<li>It works with frames: each frame is an image we can manipulate and compare with others ;</li>
<li>It brings natively a lot of image processing tools that we can use to achieve what we want ;</li>
<li>It can detect by itself the movement between two images ;</li>
</ul>
<p>By searching a bit on Internet, we were able to build a movement tracker that would create red rectangles around what move in real time.</p>
<h2 id="II-_Quantify_the_amount_of_movement">II. Quantify the amount of movement</h2><p>Once we were able to detect movement, the next issue was to quantify that movement in order to trigger or not our action.</p>
<h3 id="a-_First_try:_percentage_of_the_image_in_movement">a. First try: percentage of the image in movement</h3><p>Our first implemetation used a percentage of the image covered by red rectangles: if more than 30% of the image was in movement, we trigger the actions. However, this method wasn’t great for two main reasons:</p>
<ul>
<li>We didn’t have a notion of time, so a single big movement could be enough to trigger the system ;</li>
<li>Every single movement, even the smallest ones like a face movement, were tracked, so the percentage was pretty bad ;</li>
</ul>
<h3 id="b-_Improve_the_method_by_adding_time_and_ignoring_some_rectangles">b. Improve the method by adding time and ignoring some rectangles</h3><p>In a second and third implementations, we worked on these problems and solved them by adding a time notion and by ignoring small rectangles. Now, the motion had to be detected for a certain number of frame to trigger the event.</p>
<p>But we faced a last problem when we tested the code: if someone moved his or her hand very closely to the camera, the system would be triggered even if the motion is small. That is not what we want, so we tried to improve our algorithm.</p>
<h2 id="III-_The_motion_distance">III. The motion distance</h2><p>The best thing we could do at this step was to test and experiment. After a while, we discovered something interesting: if the motion is far enough, a single big red rectangle is created instead of a lot of small ones. Great!</p>
<p>Thus we chose to change our algorithm: instead of ignoring too small rectangles, we will consider only the biggest one for the percentage. After some tests, we were proud: our system works pretty well!</p>
<h2 id="IV-_The_final_code">IV. The final code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cv</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Target</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.capture = cv.CaptureFromCAM(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        maxSize = cv.GetCaptureProperty(self.capture, cv.CV_CAP_PROP_FRAME_WIDTH) * cv.GetCaptureProperty(self.capture, cv.CV_CAP_PROP_FRAME_HEIGHT)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Capture first frame to get size</span></span><br><span class="line">        frame = cv.QueryFrame(self.capture)</span><br><span class="line">        grey_image = cv.CreateImage(cv.GetSize(frame), cv.IPL_DEPTH_8U, <span class="number">1</span>)</span><br><span class="line">        moving_average = cv.CreateImage(cv.GetSize(frame), cv.IPL_DEPTH_32F, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        first = <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">        counting = <span class="keyword">False</span></span><br><span class="line">        movement_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            color_image = cv.QueryFrame(self.capture)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Smooth to get rid of false positives</span></span><br><span class="line">            cv.Smooth(color_image, color_image, cv.CV_GAUSSIAN, <span class="number">3</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> first:</span><br><span class="line">                difference = cv.CloneImage(color_image)</span><br><span class="line">                temp = cv.CloneImage(color_image)</span><br><span class="line">                cv.ConvertScale(color_image, moving_average, <span class="number">1.0</span>, <span class="number">0.0</span>)</span><br><span class="line">                first = <span class="keyword">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cv.RunningAvg(color_image, moving_average, <span class="number">0.020</span>, <span class="keyword">None</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Convert the scale of the moving average.</span></span><br><span class="line">            cv.ConvertScale(moving_average, temp, <span class="number">1.0</span>, <span class="number">0.0</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Minus the current frame from the moving average.</span></span><br><span class="line">            cv.AbsDiff(color_image, temp, difference)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Convert the image to grayscale.</span></span><br><span class="line">            cv.CvtColor(difference, grey_image, cv.CV_RGB2GRAY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Convert the image to black and white.</span></span><br><span class="line">            cv.Threshold(grey_image, grey_image, <span class="number">70</span>, <span class="number">255</span>, cv.CV_THRESH_BINARY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Dilate and erode to get people blobs</span></span><br><span class="line">            cv.Dilate(grey_image, grey_image, <span class="keyword">None</span>, <span class="number">18</span>)</span><br><span class="line">            cv.Erode(grey_image, grey_image, <span class="keyword">None</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">            storage = cv.CreateMemStorage(<span class="number">0</span>)</span><br><span class="line">            contour = cv.FindContours(grey_image, storage, cv.CV_RETR_CCOMP, cv.CV_CHAIN_APPROX_SIMPLE)</span><br><span class="line">            points = []</span><br><span class="line"></span><br><span class="line">            max_percentage = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> contour:</span><br><span class="line">                bound_rect = cv.BoundingRect(list(contour))</span><br><span class="line">                contour = contour.h_next()</span><br><span class="line"></span><br><span class="line">                pt1 = (bound_rect[<span class="number">0</span>], bound_rect[<span class="number">1</span>])</span><br><span class="line">                pt2 = (bound_rect[<span class="number">0</span>] + bound_rect[<span class="number">2</span>], bound_rect[<span class="number">1</span>] + bound_rect[<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">                area = bound_rect[<span class="number">3</span>] * bound_rect[<span class="number">2</span>]</span><br><span class="line">                percentage = (area / maxSize) * <span class="number">100</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> percentage &gt; max_percentage:</span><br><span class="line">                    max_percentage = percentage</span><br><span class="line"></span><br><span class="line">                points.append(pt1)</span><br><span class="line">                points.append(pt2)</span><br><span class="line">                cv.Rectangle(color_image, pt1, pt2, cv.CV_RGB(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>), <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> counting <span class="keyword">and</span> max_percentage &gt; <span class="number">75</span>:</span><br><span class="line">                movement_count = <span class="number">0</span></span><br><span class="line">                counting = <span class="keyword">True</span></span><br><span class="line">                <span class="keyword">print</span> <span class="string">"Demarrage comptage"</span></span><br><span class="line">            <span class="keyword">elif</span> counting <span class="keyword">and</span> max_percentage &gt; <span class="number">50</span>:</span><br><span class="line">                movement_count += <span class="number">1</span></span><br><span class="line">                <span class="keyword">print</span> <span class="string">"Incrementation"</span></span><br><span class="line">            <span class="keyword">elif</span> max_percentage &lt; <span class="number">20</span>:</span><br><span class="line">                movement_count = <span class="number">0</span></span><br><span class="line">                counting = <span class="keyword">False</span></span><br><span class="line">                <span class="keyword">print</span> <span class="string">"Fin comptage"</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> movement_count &gt; <span class="number">50</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"OK"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">    t = Target()</span><br><span class="line">    t.run()</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://startnao.github.io/2015/05/16/Python-OpenCV-and-Nao/" data-id="ci9txc8hu00028shchqze0yvf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Improvements" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/11/Improvements/" class="article-date">
  <time datetime="2015-05-11T18:35:09.000Z" itemprop="datePublished">11-05-2015</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/11/Improvements/">Improvements</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[1] This week, we have found a script opening a communication socket on Nao. With this one, we can send commands, having a particular syntax, to Nao, witch will analyse and execute the action. It uses the TCP protocol, on port 8080, and so can be easily used by a PHP script. </p>
<p>Moreover, the usage is very simple : Choregraphe, which has to be install on the web server machine, executes the script once. There, it constantly listen to the port 8080, and treat every message it recieved.</p>
<p>We tried to implement a way for the Nao to remember the riddles it has already asked but without an actual Nao on which to try, we don’t know if it work. For that we have written a small box that combine the “if box” and the “get data” box. We’ll try on a robot next week !</p>
<p>Today we started by trying to see more clearly through the functions proposed at this link : <a href="http://www.lucubratory.eu/independent-socket-server-on-nao/" target="_blank" rel="external">http://www.lucubratory.eu/independent-socket-server-on-nao/</a>. We are trying to see where does the error came from and how to correct it if we can. So we changed the “port” argument in the function into a chosen number (8080), we could get send packets from computer to the Nao with no loss. This means that the Nao and the computer are actually connected, but we can’t get any authentication from the Nao.<br>Thanks to this <a href="http://dhrc.snu.ac.kr/nao-robot-programming-guide-creating-a-tcpip-module-using-motion-capture-part-1/" target="_blank" rel="external">http://dhrc.snu.ac.kr/nao-robot-programming-guide-creating-a-tcpip-module-using-motion-capture-part-1/</a>, we succeeded in creating a communication socket on Nao in order to communicate with him though a web server machine.<br>Here is a picture of the Choregraphe’s boxes setting:</p>
<p><img src="/2015/05/11/Improvements/screenshot.png">   <br></p>
<p>The socket is created and the Nao will listen on port 8080 for any incoming request. We will show the code of the box later. Basically now we can communicate with Nao from the computer, we can send him some sentences to say. So the connection is done but we still have some issues:</p>
<ul>
<li>For now we still need to manually run Choregraphe in order to run the server on the Nao, but we will try to write a PHP script that would automatically run it.</li>
<li>We are still learning the syntax of the request to send to Nao, we could make him speak but for now we couldn’t make him move.</li>
<li>Also we’ve set the Nao’s right foot button as an interrupter to cut the connection.</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://startnao.github.io/2015/05/11/Improvements/" data-id="ci9txc8ig00068shcuoddm3wu" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-On-the-road" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/10/On-the-road/" class="article-date">
  <time datetime="2015-05-10T21:15:26.000Z" itemprop="datePublished">10-05-2015</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/10/On-the-road/">On the road</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[1] During the last project session we finally decided after a lot debates to give up on trin to implement a whistle detector in the Nao as it really feels difficult and we are scared to remain stuck on this until the end and get no results. </p>
<p>Instead we are going to build the web interface for Nao, the concept is to great an interface from which we could perform simple action with the Nao, like getting up, sitting, tai-chi … So we first started to search for information on how to implement a server with the Nao, we found some tutorials that unfortunatelly required some administrator access to the Nao that we don’t have, but we’re seeing with the CCRI if we could get it or not.</p>
<p>We tried to communicate with Nao by using TCP protocol. Actually, we managed to connect to his port, but there, no action was possible. So we tried to start a web server on the port 8080, using the same library that it uses in order to create the admin interface (port 80). However, we hadn’t the permissions in order to perform this action.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://startnao.github.io/2015/05/10/On-the-road/" data-id="ci9txc8if00058shctny5ihar" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Progression" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/14/Progression/" class="article-date">
  <time datetime="2015-04-14T06:16:50.000Z" itemprop="datePublished">14-04-2015</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/14/Progression/">Where we are</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<img src="/2015/04/14/Progression/IMG_20150413_175741.jpg">
<h3 id="Group_1">Group 1</h3><p>Firstly, we’ve move forward on creating customized boxes using Nao’s implemented functions which are described in the thechnical documentation. For example we’ve made a box that allow the Nao robots to record a sound and play it.</p>
<p>Furthermore we’ve find out that we can use something called “La transformation de Fourier” and implement it as a function so the Nao can isolate specific sound frequency in a record. That’s probably how we can detect whistles but research is still on going. The part of making the Nao detect someone yelling is considered as done. Indeed a box call “soundpeak” allow us to do that. Still the Nao won’t make the difference between a normal sound coming from a close source and a loud sound coming from a distance source but this not really a problem for what we are doing.</p>
<h3 id="Group_2_:">Group 2 :</h3><p>Nao need to perform some actions/movement when we are doing some large movements in front of the camera. If he cannot recognize these movements, he does a movement with his arms like protecting himself(he puts his arms in front of his face).. Which consist of not doing the good movement. And After downloading opencv, We have successfully managed to use the motion detector.</p>
<p><img src="/2015/04/14/Progression/core2.PNG">  <br></p>
<h3 id="Group_3_:">Group 3 :</h3><p>Nao starts asking if the person wants to play. In case of a negative answer, he sits down, makes his head going down, turns his eyes to red and stays like that. When the player replies positively, he asks a riddle.<br>A random question is taken in a list of 10, and NAO detects if the given answer is the correct one. He continues and takes another question, different from the old one.</p>
<p><img src="/2015/04/14/Progression/core1.PNG"> <br>  </p>
<p><img src="/2015/04/14/Progression/core3.PNG"> <br>  </p>
<h3 id="Group_4:">Group 4:</h3><p>In our team, we are trying to make Nao recognize red and blue balls. For this, we use the open source library OpenCV for the Nao.<br>We managed to analyze pictures with OpenCV and locate blue and red.<br>Today, we did not manage to use well OpenCV with the Nao.  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://startnao.github.io/2015/04/14/Progression/" data-id="ci9txc8hw00038shckbmvsze0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Welcome" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/03/25/Welcome/" class="article-date">
  <time datetime="2015-03-25T09:08:49.000Z" itemprop="datePublished">25-03-2015</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/25/Welcome/">Welcome</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to our class project blog !</p>
<p>We are currently working on a project involving Nao. The goal is to find new ways to interact with the robot.</p>
<p>We invite you to look at the <a href="/Project-Definition">project definition page</a> to learn more about the project.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://startnao.github.io/2015/03/25/Welcome/" data-id="ci9txc8hr00018shciwnigqvy" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
  
</section>
        
          <aside id="sidebar">
  
    
  
    
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/05/18/OpenCV-red-ball-detection/">OpenCV, red ball detection</a>
          </li>
        
          <li>
            <a href="/2015/05/16/Python-OpenCV-and-Nao/">Python, OpenCV and Nao</a>
          </li>
        
          <li>
            <a href="/2015/05/11/Improvements/">Improvements</a>
          </li>
        
          <li>
            <a href="/2015/05/10/On-the-road/">On the road</a>
          </li>
        
          <li>
            <a href="/2015/04/14/Progression/">Where we are</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 DUT Informatique année spéciale - IUT d&#39;Orsay<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/Project-Definition" class="mobile-nav-link">Project Definition</a>
  
    <a href="https://twitter.com/StartNao" class="mobile-nav-link">Twitter</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>